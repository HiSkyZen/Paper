From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Jake Potrebic <jake.m.potrebic@gmail.com>
Date: Fri, 24 Nov 2023 14:30:23 -0800
Subject: [PATCH] work on bytecode modifier


diff --git a/src/main/java/io/papermc/paper/event/world/StructuresLocateEvent.java b/src/main/java/io/papermc/paper/event/world/StructuresLocateEvent.java
index 4342b162f69b6509503e9772ddd2c5ac6659545a..fdb2944f75728d8dcb6a5085db14e1c0cadd2f6b 100644
--- a/src/main/java/io/papermc/paper/event/world/StructuresLocateEvent.java
+++ b/src/main/java/io/papermc/paper/event/world/StructuresLocateEvent.java
@@ -193,7 +193,7 @@ public class StructuresLocateEvent extends WorldEvent implements Cancellable {
 
         @Deprecated(forRemoval = true)
         public Result(final @NotNull Location position, @NotNull ConfiguredStructure configuredStructure) {
-            this(position, configuredStructure.toModern());
+            this(position.asPosition(), configuredStructure.toModern());
         }
 
         @Deprecated(forRemoval = true)
diff --git a/src/main/java/org/bukkit/Location.java b/src/main/java/org/bukkit/Location.java
index 13f221dd4e332db01195eb0c92ef9f26a17eb6d6..8a968877b699411ec2a145a7526b3d5ea11e0ff7 100644
--- a/src/main/java/org/bukkit/Location.java
+++ b/src/main/java/org/bukkit/Location.java
@@ -30,7 +30,7 @@ import org.bukkit.entity.Player;
  * magnitude than 360 are valid, but may be normalized to any other equivalent
  * representation by the implementation.
  */
-public class Location implements Cloneable, ConfigurationSerializable, io.papermc.paper.math.FinePosition { // Paper
+public class Location implements Cloneable, ConfigurationSerializable/*, io.papermc.paper.math.FinePosition*/ { // Paper
     private Reference<World> world;
     private double x;
     private double y;
@@ -120,7 +120,7 @@ public class Location implements Cloneable, ConfigurationSerializable, io.paperm
      */
     @NotNull
     public Chunk getChunk() {
-        return getWorld().getChunkAt(this);
+        return getWorld().getChunkAt(this.asPosition());
     }
 
     /**
@@ -130,7 +130,7 @@ public class Location implements Cloneable, ConfigurationSerializable, io.paperm
      */
     @NotNull
     public Block getBlock() {
-        return getWorld().getBlockAt(this);
+        return getWorld().getBlockAt(this.asPosition());
     }
 
     /**
@@ -1180,29 +1180,32 @@ public class Location implements Cloneable, ConfigurationSerializable, io.paperm
     }
 
     // Paper - add Position
-    @Override
-    public double x() {
-        return this.getX();
-    }
-
-    @Override
-    public double y() {
-        return this.getY();
-    }
-
-    @Override
-    public double z() {
-        return this.getZ();
-    }
-
-    @Override
-    public boolean isFinite() {
-        return io.papermc.paper.math.FinePosition.super.isFinite() && Float.isFinite(this.getYaw()) && Float.isFinite(this.getPitch());
-    }
-
-    @Override
-    public @NotNull Location toLocation(@NotNull World world) {
-        return new Location(world, this.x(), this.y(), this.z(), this.getYaw(), this.getPitch());
-    }
+    public io.papermc.paper.math.Position asPosition() {
+        return io.papermc.paper.math.Position.fine(this);
+    }
+    // @Override
+    // public double x() {
+    //     return this.getX();
+    // }
+    //
+    // @Override
+    // public double y() {
+    //     return this.getY();
+    // }
+    //
+    // @Override
+    // public double z() {
+    //     return this.getZ();
+    // }
+    //
+    // @Override
+    // public boolean isFinite() {
+    //     return io.papermc.paper.math.FinePosition.super.isFinite() && Float.isFinite(this.getYaw()) && Float.isFinite(this.getPitch());
+    // }
+    //
+    // @Override
+    // public @NotNull Location toLocation(@NotNull World world) {
+    //     return new Location(world, this.x(), this.y(), this.z(), this.getYaw(), this.getPitch());
+    // }
     // Paper end
 }
diff --git a/src/main/java/org/bukkit/World.java b/src/main/java/org/bukkit/World.java
index 5eb3521f5f91b0684b4beebf4f7ba2c795b41c42..81e393865eb0c8ec7efb6ebcbd0376b2354ecf20 100644
--- a/src/main/java/org/bukkit/World.java
+++ b/src/main/java/org/bukkit/World.java
@@ -95,7 +95,7 @@ public interface World extends RegionAccessor, WorldInfo, PluginMessageRecipient
      * @return Block at the given location
      */
     @NotNull
-    public Block getBlockAt(@NotNull Location location);
+    public Block getBlockAt(@NotNull io.papermc.paper.math.Position location);
 
     // Paper start
     /**
@@ -285,7 +285,7 @@ public interface World extends RegionAccessor, WorldInfo, PluginMessageRecipient
      * @return Chunk at the given location
      */
     @NotNull
-    public Chunk getChunkAt(@NotNull Location location);
+    public Chunk getChunkAt(@NotNull io.papermc.paper.math.Position location);
 
     /**
      * Gets the {@link Chunk} that contains the given {@link Block}
@@ -746,7 +746,7 @@ public interface World extends RegionAccessor, WorldInfo, PluginMessageRecipient
      * @return {@link Location} of Lightning Rod or {@code null}
      */
     @Nullable
-    public Location findLightningRod(@NotNull Location location);
+    public Location findLightningRod(@NotNull io.papermc.paper.math.Position location);
 
     /**
      * Finds a target {@link Location} for lightning to strike.
diff --git a/src/main/java/org/bukkit/block/Sign.java b/src/main/java/org/bukkit/block/Sign.java
index 94e8f319fe0413a10496d7e5bba70633054765f4..5de0959c9b554c821ef6cccdfe6f7350713ccdf0 100644
--- a/src/main/java/org/bukkit/block/Sign.java
+++ b/src/main/java/org/bukkit/block/Sign.java
@@ -176,7 +176,7 @@ public interface Sign extends TileState, Colorable {
      * @return the side it is facing
      */
     default @NotNull Side getInteractableSideFor(org.bukkit.entity.@NotNull Entity entity) {
-        return this.getInteractableSideFor(entity.getLocation());
+        return this.getInteractableSideFor(entity.getLocation().asPosition());
     }
 
     /**
